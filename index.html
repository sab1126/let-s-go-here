<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>解壓縮圖片顯示</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
    <h1>顯示解壓縮圖片</h1>
    <div id="image-container" style="text-align: center;"></div>
    <p id="file-name" style="text-align: center; font-size: 1.2em; margin-top: 10px;"></p>

    <script>
        async function loadAndDisplayImages() {
            const zipFilePath = './images/images1.zip';
            const totalImages = 59; // Number of images in the zip
            const imagePrefix = 'images1/';
            const imageExtension = '.jpg';
            let currentIndex = 1;

            try {
                const response = await fetch(zipFilePath);
                if (!response.ok) {
                    throw new Error('無法讀取壓縮檔案');
                }

                const zipBlob = await response.blob();
                const zip = await JSZip.loadAsync(zipBlob);

                function updateImage() {
                    const fileName = `${imagePrefix}${currentIndex}${imageExtension}`;
                    if (zip.files[fileName]) {
                        zip.files[fileName].async('blob').then(imageBlob => {
                            const imageUrl = URL.createObjectURL(imageBlob);
                            const imgElement = document.getElementById('image');
                            const fileNameElement = document.getElementById('file-name');

                            if (!imgElement) {
                                const newImg = document.createElement('img');
                                newImg.id = 'image';
                                newImg.style.maxWidth = '100%';
                                newImg.style.height = 'auto';
                                document.getElementById('image-container').appendChild(newImg);
                            }

                            document.getElementById('image').src = imageUrl;
                            fileNameElement.textContent = `檔案名稱: ${fileName}`;

                            currentIndex = (currentIndex % totalImages) + 1; // Move to next image
                        });
                    } else {
                        console.warn(`壓縮檔案中找不到圖片 ${fileName}`);
                    }
                }

                // Start the slideshow
                setInterval(updateImage, 300); // 0.3 seconds per image
                updateImage(); // Display the first image immediately
            } catch (error) {
                console.error('解壓縮過程中發生錯誤：', error);
                alert('無法解壓縮或顯示圖片，請確認壓縮檔案是否正確。');
            }
        }

        loadAndDisplayImages();
    </script>
</body>
</html>
